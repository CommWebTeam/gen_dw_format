<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Format dw paste - general Dreamweaver paste formatting</title>
</head>

<body>
  <p>This tool performs some basic formatting checks on Dreamweaver documents pasted from Word. <strong>Before using the tool, make sure that:</strong>
    <ol>
      <li>you have accepted all tracked changes and removed all comments in the Word document.</li>
      <li>the pasted HTML document has proper indentation (in Dreamweaver, Edit -> Code -> Apply Source Formatting).</li>
      <li>the pasted HTML document uses double quotes (e.g. "x") instead of single quotes (e.g. 'x') for tag attributes.</li>
      <li>if required, superscripts/subscripts have been converted to fake tags (see the <a rel="external" href="https://commwebteam.github.io/gen_dw_format/dreamweaver_paste_formatter/#details-on-changing-strings-indicating-tags-to-actual-tags">readme</a> for details).</li>
      <li>if required, math equations have been converted to MathML.</li>
    </ol>
  </p>
  <br />
  File to format:
  <input id="html_file" type="file">
  <br />
  <br />
  <br />
  <label for="select_checks">Select default checks for:</label>
  <select name="select_checks" id="select_checks" onchange="set_default_checks()">
    <option value="en_dw">English Word document pasted into Dreamweaver</option>
    <option value="fr_dw">French Word document pasted into Dreamweaver</option>
    <option value="en_wet">English partially WET-formatted document</option>
    <option value="fr_wet">French partially WET-formatted document</option>
    <option value="uncheck">Uncheck all</option>
  </select>
  <br />
  <br />
  <br />
  <b>Format Dreamweaver footnotes</b> (use the <a href="../footnote_formatter/format_footnote.html"> footnote formatter</a> if the footnotes don't use Dreamweaver's formatting): <br />
  <input type="checkbox" id="footnotes" name="footnotes" checked>
  <label for="footnotes">*Format (English) footnotes</label>
  <br />
  <br />
  <b>Remove Dreamweaver-generated links:</b> <br />
  <input type="checkbox" id="dw_empty_a" name="dw_empty_a" checked>
  <label for="dw_empty_a">Remove empty links (except for Dreamweaver-generated footnotes)</label>
  <br />
  <input type="checkbox" id="dw_ref" name="dw_ref" checked>
  <label for="dw_ref">*Remove Dreamweaver-generated _Ref links</label>
  <br />
  <input type="checkbox" id="dw_toc" name="dw_toc" checked>
  <label for="dw_toc">*Remove Dreamweaver-generated _Toc links</label>
  <br />
  <input type="checkbox" id="dw_bookmark" name="dw_bookmark" checked>
  <label for="dw_bookmark">*Remove Dreamweaver-generated _bookmark links</label>
  <br />
  <input type="checkbox" id="logiterms" name="logiterms" checked>
  <label for="logiterms">*Remove French logiterms</label>
  <br />
  <br />
  <b>Clean up spacing for coding style:</b> <br />
  <input type="checkbox" id="space_format" name="space_format" checked>
  <label for="space_format">Convert invisible &amp;nbsp;, tabs, and so on to regular spaces</label>
  <br />
  <input type="checkbox" id="multispace" name="multispace" checked>
  <label for="multispace">Get rid of multiple consecutive spaces</label>
  <br />
  <input type="checkbox" id="end_tag_space" name="end_tag_space" checked>
  <label for="end_tag_space">Remove ending spaces inside tags</label>
  <br />
  <input type="checkbox" id="empty_tag" name="empty_tag" checked>
  <label for="empty_tag">Remove empty, attribute-less tags</label>
  <br />
  <input type="checkbox" id="space_after_open" name="space_after_open" checked>
  <label for="space_after_open">Remove spaces after opening p, li, th, td, and header tags</label>
  <br />
  <input type="checkbox" id="space_before_close" name="space_before_close" checked>
  <label for="space_before_close">Remove spaces before closing p, li, th, td, and header tags</label>
  <br />
  <br />
  <b>Replace Word-formatted characters/html entities:</b> <br />
  <input type="checkbox" id="quote_values" name="quote_values" checked>
  <label for="quote_values">Replace straight quote HTML entities with their values</label>
  <br />
  <input type="checkbox" id="fancy_quotes" name="fancy_quotes">
  <label for="fancy_quotes">Replace fancy quotes with straight quotes</label>
  <br />
  <input type="checkbox" id="fancy_quote_entities" name="fancy_quote_entities">
  <label for="fancy_quote_entities">Replace fancy quote HTML entities with straight quotes</label>
  <br />
  <input type="checkbox" id="fancy_quote_values" name="fancy_quote_values">
  <label for="fancy_quote_values">Replace fancy quote HTML entities with their values</label>
  <br />
  <input type="checkbox" id="emdash" name="emdash" checked>
  <label for="emdash">Replace em dashes with regular dashes</label>
  <br />
  <br />
  <b>Join consecutive tags of the same type:</b> <br />
  <input type="checkbox" id="consecutive_em" name="consecutive_em" checked>
  <label for="consecutive_em">Join em and strong that are only separated by spaces</label>
  <br />
  <input type="checkbox" id="consecutive_em_punct" name="consecutive_em_punct">
  <label for="consecutive_em_punct">Join em and strong that are separated by spaces or punctuation</label>
  <br />
  <input type="checkbox" id="consecutive_ul" name="consecutive_ul" checked>
  <label for="consecutive_ul">Join consecutive ul tags</label>
  <br />
  <input type="checkbox" id="consecutive_ol" name="consecutive_ol" checked>
  <label for="consecutive_ol" style="color:red">**Join consecutive ol tags**</label>
  <br />
  <br />
  <b>Replace/remove/format &lt;br> tags:</b> <br />
  <input type="checkbox" id="rm_empty_br" name="rm_empty_br" checked>
  <label for="rm_empty_br">Remove br at the start or end of p, li, th, td, and header tags</label>
  <br />
  <input type="checkbox" id="split_p_br" name="split_p_br">
  <label for="split_p_br">Split paragraphs separated by br into multiple &lt;p> tags</label>
  <br />
  <input type="checkbox" id="split_p_br_punct" name="split_p_br_punct" checked>
  <label for="split_p_br_punct">Split paragraphs separated by br into multiple &lt;p> tags if the first paragraph ends in punctuation</label>
  <br />
  <input type="checkbox" id="fix_br" name="fix_br" checked>
  <label for="fix_br">Change all &lt;br> to &lt;br /></label>
  <br />
  <br />
  <b>Remove formatting around punctuation:</b> <br />
  <input type="checkbox" id="rm_punct_format" name="rm_punct_format" checked>
  <label for="rm_punct_format">Remove em and strong that only consist of spacing and . , ; :</label>
  <br />
  <input type="checkbox" id="fix_punct" name="fix_punct" checked>
  <label for="fix_punct">Remove incorrect spacing before punctuation, and duplicate punctuation, for  . , ; :</label>
  <br />
  <br />
  <b>Replace em/strong with other tags for italics/bold:</b> <br />
  <input type="checkbox" id="cite_link" name="cite_link" checked>
  <label for="cite_link">Change em to cite on lines that have links</label>
  <br />
  <input type="checkbox" id="default_cite" name="default_cite">
  <label for="default_cite">Change all em to cite by default</label>
  <br />
  <input type="checkbox" id="default_oti" name="default_oti">
  <label for="default_oti">Change all em to span class="osfi-txt--italic" by default</label>
  <br />
  <input type="checkbox" id="default_i" name="default_i">
  <label for="default_i">Change all em to i by default</label>
  <br />
  <input type="checkbox" id="default_otb" name="default_otb">
  <label for="default_otb">Change all strong to span class="osfi-txt--bold" by default</label>
  <br />
  <input type="checkbox" id="default_b" name="default_b">
  <label for="default_b">Change all strong to b by default</label>
  <br />
  <br />
  <b>Add/fix/remove tag attributes:</b> <br />
  <input type="checkbox" id="align" name="align" checked>
  <label for="align">*Change center and right alignment to WET class</label>
  <br />
  <input type="checkbox" id="ref_links" name="ref_links" checked>
  <label for="ref_links">*Make OSFI links referential and other links external</label>
  <br />
  <input type="checkbox" id="p_tag" name="p_tag" checked>
  <label for="p_tag" style="color:red">**Remove attributes from p tags**</label>
  <br />
  <input type="checkbox" id="ol_ul_tag" name="ol_ul_tag" checked>
  <label for="ol_ul_tag" style="color:red">**Remove attributes from ol and ul tags**</label>
  <br />
  <input type="checkbox" id="table_tag" name="table_tag" checked>
  <label for="table_tag" style="color:red">**Remove attributes from table tags (table, th, tr, td) - excludes colspan/rowspan for td**</label>
  <br />
  <br />
  <b>Translate structure for French documents:</b> <br />
  <input type="checkbox" id="translate" name="translate">
  <label for="translate">Translate internal links and footnote structure to French</label>
  <br />
  <input type="checkbox" id="translate_script" name="translate_script">
  <label for="translate_script">Add superscripts for 1er and #e (French numbering)</label>
  <br />
  <input type="checkbox" id="nbsp_pct" name="nbsp_pct">
  <label for="nbsp_pct">Add &amp;nbsp; in front of % and $</label>
  <br />
  <br />
  <b>Convert manually inserted fake tags to actual tags</b> (see <a rel="external" href="https://commwebteam.github.io/gen_dw_format/dreamweaver_paste_formatter/#details-on-changing-strings-indicating-tags-to-actual-tags">this readme section</a> for details): <br />
  <input type="checkbox" id="fake_script_tag" name="fake_script_tag" checked>
  <label for="fake_script_tag">*Convert visual superscript/subscript tags (with &amp;lt; and so on) to actual tags</label> <br />
  <button id="script_steps_button" onclick="toggle_script_steps()">Show steps to add/remove superscripts and subscripts</button>
  <div id="script_steps" style="border:solid;display:none">
    <p>See the readme for an explanation of what this is for.</p>
    <p>Steps to mark superscripts and subscripts in word:</p>
    <ol>
      <li>Open the "replace" box in Word (ctrl+h).</li>
      <li>Select "More >>" for additional options.</li>
      <li>Check "Use wildcards".</li>
      <li>In the "Find what" box, enter ([!(^2)]).</li>
      <li>While in the "Find what" box, select "Format", then "Font".</li>
      <li>Only check the "Superscript" box. Leave the "Subscript" box unchecked; all other boxes should be filled in, but not checked.</li>
      <li>Click "OK". You are now searching for superscript text.</li>
      <li>In the "Replace with" box, enter &lt;sup>\1&lt;/sup>.</li>
      <li>While in the "Replace with" box, select "Format", then "Font".</li>
      <li>Only check the "Superscript" box. Leave the "Subscript" box unchecked; all other boxes should be filled in, but not checked.</li>
      <li>Click "OK". You are now replacing superscript text.</li>
      <li>Click "Replace All" to surround all superscripts with &lt;sup> and &lt;/sup>.</li>
    </ol>
    <p>Afterwards, repeat these steps for subscripts, but use &lt;sub>\1&lt;/sub> for step 8 instead.</p>
  </div>
  <br />
  <input type="checkbox" id="fake_math_tag" name="fake_math_tag" checked>
  <label for="fake_math_tag">*Convert visual math tags (with &amp;lt; and so on) to actual tags - to be used alongside the macro</label>
  <br />
  <br />
<button onclick="format_file()">Download formatted file</button>
<br />
<br />
<p>A few of these checks assume Dreamweaver formatting when searching for values, and may not be useful if the document has already been partially converted to WET formatting.
  <ul>
    <li>The checks that explicitly search for strings that Dreamweaver formatting generates (e.g. links beginning in _Ref) have been marked with *. These have no effect if the document has already been manually formatted, and can be left checked or unchecked.</li>
    <li>A few checks assume Dreamweaver formatting by design (e.g. removing attributes from ol tags because, when generated by Dreamweaver, they generally aren't useful), and may remove manually inserted WET formatting. <span style="color:red">These have been marked with ** and coloured red</span>, and should be unchecked if the document has already been manually formatted.</li>
  </ul></p>
<p>This tool removes indentation, so be sure to apply source formatting with Dreamweaver afterwards to fix it.</p>
<p>Check the console (ctrl+shift+i) for any errors if nothing is loading.</p>
<p>More in-depth information, including examples for individual checks, can be found in the <a rel="external" href="https://commwebteam.github.io/gen_dw_format/dreamweaver_paste_formatter/">readme</a>.</p>
<script src="../format_helpers.js"></script> 
<script src="../download.js"></script> 
<script src="../footnote_formatter/format_footnote_helpers.js"></script> 
<script src="format_dw_paste_helpers.js"></script> 
</body>
</html>
