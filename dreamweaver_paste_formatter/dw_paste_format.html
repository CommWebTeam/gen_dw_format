<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>General Dreamweaver paste formatting</title>
</head>

<body>
<form>
  File to format:
  <input id="html_file" type="file">
  <br/>
  <br/>
  <b>Remove Dreamweaver-generated links:</b> <br/>
  <input type="checkbox" id="dw_empty_a" name="dw_empty_a" checked>
  <label for="dw_empty_a">Remove empty links</label>
  <br/>
  <input type="checkbox" id="dw_ref" name="dw_ref" checked>
  <label for="dw_ref">*Remove Dreamweaver-generated _Ref links</label>
  <br/>
  <input type="checkbox" id="dw_toc" name="dw_toc" checked>
  <label for="dw_toc">*Remove Dreamweaver-generated _Toc links</label>
  <br/>
  <input type="checkbox" id="dw_bookmark" name="dw_bookmark" checked>
  <label for="dw_bookmark">*Remove Dreamweaver-generated _bookmark links</label>
  <br/>
  <input type="checkbox" id="logiterms" name="logiterms" checked>
  <label for="logiterms">*Remove French logiterms</label>
  <br/>
  <br/>
  <b>Clean up spacing for coding style:</b> <br/>
  <input type="checkbox" id="space_format" name="space_format" checked>
  <label for="space_format">Convert invisible &amp;nbsp; to regular spaces</label>
  <br/>
  <input type="checkbox" id="multispace" name="multispace" checked>
  <label for="multispace">Get rid of multiple consecutive spaces</label>
  <br/>
  <input type="checkbox" id="end_tag_space" name="end_tag_space" checked>
  <label for="end_tag_space">Remove ending spaces inside tags</label>
  <br/>
  <input type="checkbox" id="empty_tag" name="empty_tag" checked>
  <label for="empty_tag">Remove empty, attribute-less tags</label>
  <br/>
  <input type="checkbox" id="space_before_close" name="space_before_close" checked>
  <label for="space_before_close">Remove spaces before closing p, li, th, td, and header tags</label>
  <br/>
  <br/>
  <b>Replace word-formatted characters/html entities:</b> <br/>
  <input type="checkbox" id="quote_values" name="quote_values" checked>
  <label for="quote_values">Replace straight quote HTML entities with their values</label>
  <br/>
  <input type="checkbox" id="fancy_quotes" name="fancy_quotes">
  <label for="fancy_quotes">Replace fancy quotes with straight quotes</label>
  <br/>
  <input type="checkbox" id="fancy_quote_entities" name="fancy_quote_entities">
  <label for="fancy_quote_entities">Replace fancy quote HTML entities with straight quotes</label>
  <br/>
  <input type="checkbox" id="fancy_quote_values" name="fancy_quote_values">
  <label for="fancy_quote_values">Replace fancy quote HTML entities with their values</label>
  <br/>
  <input type="checkbox" id="emdash" name="emdash" checked>
  <label for="emdash">Replace em dashes with regular dashes</label>
  <br/>
  <br/>
  <b>Join consecutive tags of the same type:</b> <br/>
  <input type="checkbox" id="consecutive_em" name="consecutive_em" checked>
  <label for="consecutive_em">Join em and strong that are only separated by spaces</label>
  <br/>
  <input type="checkbox" id="consecutive_ul" name="consecutive_ul" checked>
  <label for="consecutive_ul">Join consecutive ul tags</label>
  <br/>
  <input type="checkbox" id="consecutive_ol" name="consecutive_ol" checked>
  <label for="consecutive_ol">**Join consecutive ol tags**</label>
  <br/>
  <br/>
  <b>Replace em/strong with other tags for italics/bold:</b> <br/>
  <input type="checkbox" id="cite_link" name="cite_link" checked>
  <label for="cite_link">Change em to cite on lines that have links</label>
  <br/>
  <input type="checkbox" id="default_cite" name="default_cite">
  <label for="default_cite">Change all em to cite by default</label>
  <br/>
  <input type="checkbox" id="default_oti" name="default_oti">
  <label for="default_oti">Change all em to span class="osfi-txt--italic" by default</label>
  <br/>
  <input type="checkbox" id="default_i" name="default_i">
  <label for="default_i">Change all em to i by default</label>
  <br/>
  <input type="checkbox" id="default_otb" name="default_otb">
  <label for="default_otb">Change all strong to span class="osfi-txt--bold" by default</label>
  <br/>
  <input type="checkbox" id="default_b" name="default_b">
  <label for="default_b">Change all strong to b by default</label>
  <br/>
  <br/>
  <b>Replace/remove/format &lt;br> tags:</b> <br/>
  <input type="checkbox" id="split_p_br" name="split_p_br">
  <label for="split_p_br">Split paragraphs separated by br into multiple &lt;p> tags</label>
  <br/>
  <input type="checkbox" id="split_p_br_punct" name="split_p_br_punct" checked>
  <label for="split_p_br_punct">Split paragraphs separated by br into multiple &lt;p> tags if the first paragraph ends in punctuation</label>
  <br/>
  <input type="checkbox" id="rm_empty_br" name="rm_empty_br" checked>
  <label for="rm_empty_br">Remove br at the start or end of p, li, th, td, and header tags</label>
  <br/>
  <input type="checkbox" id="fix_br" name="fix_br" checked>
  <label for="fix_br">Change all &lt;br> to &lt;br/></label>
  <br/>
  <br/>
  <b>Add/fix/remove tag attributes:</b> <br/>
  <input type="checkbox" id="ref_links" name="ref_links" checked>
  <label for="ref_links">Make OSFI links referential and other links external</label>
  <br/>
  <input type="checkbox" id="align" name="align" checked>
  <label for="align">*Change center and right alignment to WET class</label>
  <br/>
  <input type="checkbox" id="p_tag" name="p_tag" checked>
  <label for="p_tag">**Remove attributes from p tags**</label>
  <br/>
  <input type="checkbox" id="ol_ul_tag" name="ol_ul_tag" checked>
  <label for="ol_ul_tag">**Remove attributes from ol and ul tags**</label>
  <br/>
  <input type="checkbox" id="table_tag" name="table_tag" checked>
  <label for="table_tag">**Remove attributes from table tags (table, th, tr, td) - excludes colspan/rowspan for td**</label>
  <br/>
  <br/>
  <b>Format Dreamweaver footnotes</b> (use the <a rel="external" href="https://commwebteam.github.io/gen_dw_format/footnote_formatter/"> footnote formatter</a> if the footnotes don't use Dreamweaver's formatting): <br/>
  <input type="checkbox" id="footnotes" name="footnotes" checked>
  <label for="footnotes">*Format (English) footnotes</label>
  <br/>
  <br/>
  <b>Fix spacing issues surrounding punctuation:</b> <br/>
  <input type="checkbox" id="fix_punct" name="fix_punct" checked>
  <label for="fix_punct">Remove incorrect spacing before punctuation/duplicate punctuation for  . , ; :</label>
  <br/>
  <br/>
  <b>Translate structure for French documents:</b> <br/>
  <input type="checkbox" id="translate" name="translate">
  <label for="translate">Translate internal links and footnote structure to French</label>
  <br/>
  <input type="checkbox" id="translate_script" name="translate_script">
  <label for="translate_script">Add superscripts for 1er and #e (French numbering)</label>
  <br/>
  <input type="checkbox" id="nbsp_pct" name="nbsp_pct">
  <label for="nbsp_pct">Add &amp;nbsp; in front of % and $</label>
  <br/>
  <br/>
  <b>Convert manually inserted fake tags to actual tags</b> (see the <a rel="external" href="https://commwebteam.github.io/gen_dw_format/dreamweaver_paste_formatter/#details-on-changing-strings-indicating-tags-to-actual-tags">readme</a> for details): <br/>
  <input type="checkbox" id="fake_script_tag" name="fake_script_tag" checked>
  <label for="fake_script_tag">*Convert visual superscript/subscript tags (with &amp;lt; and so on) to actual tags</label>
  <br/>
  <input type="checkbox" id="fake_math_tag" name="fake_math_tag" checked>
  <label for="fake_math_tag">*Convert visual math tags (with &amp;lt; and so on) to actual tags - to be used alongside the macro</label>
  <br/>
  <br/>
</form>
<button onclick="format_file()">Download formatted file</button>
<br/>
<br/>
<p>This tool performs some quick formatting on Dreamweaver documents pasted from word. It assumes proper indentation (in Dreamweaver, Edit -> Code -> Apply Source Formatting).</p>
<p>A few of these checks assume Dreamweaver formatting when searching for values, and may not be useful if the document has already been partially converted to WET formatting.
  <ul>
    <li>The checks that explicitly search for strings that Dreamweaver formatting generates (e.g. links beginning in _Ref) have been marked with *. These have no effect if the document has already been manually formatted.</li>
    <li>The checks that assume Dreamweaver formatting by design (e.g. removing attributes from ol tags because, when generated by Dreamweaver, they generally aren't useful), and may remove manually inserted WET formatting, have been marked with **. <strong>These should be unchecked if the document has already been manually formatted.</strong></li>
  </ul></p>
<p>This tool removes indentation, so be sure to apply source formatting with Dreamweaver afterwards to fix it.</p>
<p>Check the console (ctrl+shift+i) for any errors if nothing is loading.</p>
<p>More in-depth information, including examples for individual checks, can be found in the <a rel="external" href="https://commwebteam.github.io/gen_dw_format/dreamweaver_paste_formatter/">readme</a>.</p>
<script src="https://commwebteam.github.io/util/format_helpers.js"></script> 
<script src="https://commwebteam.github.io/util/download.js"></script> 
<script src="../footnote_formatter/footnote_helpers.js"></script> 
<script src="dw_paste_format_helpers.js"></script> 
</body>
</html>
